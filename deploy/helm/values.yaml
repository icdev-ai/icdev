# CUI // SP-CTI
# ICDEV On-Premises Configuration
# Override these values for your environment:
#   helm install icdev ./helm -f my-values.yaml

# -----------------------------------------------------------------------
# Global
# -----------------------------------------------------------------------
global:
  classification: CUI
  impactLevel: IL4            # IL2 | IL4 | IL5 | IL6
  namespace: icdev
  imagePullSecrets: []

# -----------------------------------------------------------------------
# Container images
# -----------------------------------------------------------------------
image:
  repository: icdev
  tag: "21.0.0"
  pullPolicy: IfNotPresent

# -----------------------------------------------------------------------
# API Gateway (main entry-point — routes to internal agents)
# -----------------------------------------------------------------------
apiGateway:
  replicas: 2
  port: 8443
  resources:
    requests:
      cpu: 500m
      memory: 1Gi
    limits:
      cpu: "2"
      memory: 4Gi
  nodeSelector: {}
  tolerations: []
  affinity: {}

# -----------------------------------------------------------------------
# Orchestrator Agent — Core Tier (port 8443)
# -----------------------------------------------------------------------
orchestrator:
  enabled: true
  replicas: 1
  port: 8443
  resources:
    requests:
      cpu: 250m
      memory: 512Mi
    limits:
      cpu: "1"
      memory: 2Gi

# -----------------------------------------------------------------------
# Architect Agent — Core Tier (port 8444)
# -----------------------------------------------------------------------
architect:
  enabled: true
  replicas: 1
  port: 8444
  resources:
    requests:
      cpu: 250m
      memory: 256Mi
    limits:
      cpu: "1"
      memory: 2Gi

# -----------------------------------------------------------------------
# Builder Agent — Domain Tier (port 8445)
# -----------------------------------------------------------------------
builder:
  enabled: true
  replicas: 2
  port: 8445
  resources:
    requests:
      cpu: 500m
      memory: 1Gi
    limits:
      cpu: "2"
      memory: 4Gi

# -----------------------------------------------------------------------
# Compliance Agent — Domain Tier (port 8446)
# -----------------------------------------------------------------------
compliance:
  enabled: true
  replicas: 1
  port: 8446
  resources:
    requests:
      cpu: 250m
      memory: 512Mi
    limits:
      cpu: "1"
      memory: 2Gi

# -----------------------------------------------------------------------
# Security Agent — Domain Tier (port 8447)
# -----------------------------------------------------------------------
security:
  enabled: true
  replicas: 1
  port: 8447
  resources:
    requests:
      cpu: 250m
      memory: 512Mi
    limits:
      cpu: "1"
      memory: 2Gi

# -----------------------------------------------------------------------
# Infrastructure Agent — Domain Tier (port 8448)
# -----------------------------------------------------------------------
infrastructure:
  enabled: true
  replicas: 1
  port: 8448
  resources:
    requests:
      cpu: 200m
      memory: 256Mi
    limits:
      cpu: "1"
      memory: 2Gi

# -----------------------------------------------------------------------
# Knowledge Agent — Support Tier (port 8449)
# -----------------------------------------------------------------------
knowledge:
  enabled: true
  replicas: 1
  port: 8449
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 1Gi

# -----------------------------------------------------------------------
# Monitor Agent — Support Tier (port 8450)
# -----------------------------------------------------------------------
monitor:
  enabled: true
  replicas: 1
  port: 8450
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 1Gi

# -----------------------------------------------------------------------
# MBSE Agent — Domain Tier (port 8451)
# -----------------------------------------------------------------------
mbse:
  enabled: true
  replicas: 1
  port: 8451
  resources:
    requests:
      cpu: 200m
      memory: 256Mi
    limits:
      cpu: "1"
      memory: 2Gi

# -----------------------------------------------------------------------
# Modernization Agent — Domain Tier (port 8452)
# -----------------------------------------------------------------------
modernization:
  enabled: true
  replicas: 1
  port: 8452
  resources:
    requests:
      cpu: 200m
      memory: 256Mi
    limits:
      cpu: "1"
      memory: 2Gi

# -----------------------------------------------------------------------
# Requirements Analyst Agent — Domain Tier (port 8453)
# -----------------------------------------------------------------------
requirements-analyst:
  enabled: true
  replicas: 1
  port: 8453
  resources:
    requests:
      cpu: 200m
      memory: 256Mi
    limits:
      cpu: "1"
      memory: 2Gi

# -----------------------------------------------------------------------
# Supply Chain Agent — Domain Tier (port 8454)
# -----------------------------------------------------------------------
supply-chain:
  enabled: true
  replicas: 1
  port: 8454
  resources:
    requests:
      cpu: 150m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 1Gi

# -----------------------------------------------------------------------
# Simulation Agent — Domain Tier (port 8455)
# -----------------------------------------------------------------------
simulation:
  enabled: true
  replicas: 1
  port: 8455
  resources:
    requests:
      cpu: 200m
      memory: 256Mi
    limits:
      cpu: "1"
      memory: 2Gi

# -----------------------------------------------------------------------
# DevSecOps Agent — Domain Tier (port 8457)
# -----------------------------------------------------------------------
devsecops:
  enabled: true
  replicas: 1
  port: 8457
  resources:
    requests:
      cpu: 200m
      memory: 256Mi
    limits:
      cpu: "1"
      memory: 2Gi

# -----------------------------------------------------------------------
# Gateway Agent — Domain Tier (port 8458)
# -----------------------------------------------------------------------
gateway:
  enabled: true
  replicas: 1
  port: 8458
  resources:
    requests:
      cpu: 150m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 1Gi

# -----------------------------------------------------------------------
# Dashboard — Web UI (port 5000)
# -----------------------------------------------------------------------
dashboard:
  enabled: true
  replicas: 2
  port: 5000
  existingSecret: ""          # K8s secret with key "secret_key" for ICDEV_DASHBOARD_SECRET
  resources:
    requests:
      cpu: 200m
      memory: 256Mi
    limits:
      cpu: "1"
      memory: 1Gi

# -----------------------------------------------------------------------
# Platform Database
# -----------------------------------------------------------------------
platformDb:
  type: internal              # "internal" (StatefulSet) or "external" (customer RDS)
  host: ""                    # Required if type=external
  port: 5432
  name: icdev_platform
  user: icdev
  existingSecret: ""          # K8s secret with key "password"; auto-created if empty
  storage:
    size: 20Gi
    storageClass: ""          # Empty = default StorageClass
  resources:
    requests:
      cpu: 250m
      memory: 512Mi
    limits:
      cpu: "1"
      memory: 2Gi

# -----------------------------------------------------------------------
# License
# -----------------------------------------------------------------------
license:
  existingSecret: icdev-license   # K8s secret with key "license.json"

# -----------------------------------------------------------------------
# TLS
# -----------------------------------------------------------------------
tls:
  enabled: true
  certSecretName: icdev-tls       # K8s TLS secret (tls.crt + tls.key)

# -----------------------------------------------------------------------
# Amazon Bedrock (LLM inference)
# -----------------------------------------------------------------------
bedrock:
  enabled: true
  region: us-gov-west-1
  modelId: anthropic.claude-3-sonnet-20240229-v1:0
  existingSecret: ""              # AWS credentials secret; empty = use IAM role

# -----------------------------------------------------------------------
# Monitoring
# -----------------------------------------------------------------------
monitoring:
  enabled: true
  prometheusPort: 9090
  grafana:
    enabled: false
    adminPassword: ""             # Set or use existingSecret
  elk:
    enabled: false
    host: ""
  splunk:
    enabled: false
    host: ""
    hecToken: ""

# -----------------------------------------------------------------------
# CUI Marking Settings
# -----------------------------------------------------------------------
cui:
  bannerTop: "CUI // SP-CTI"
  bannerBottom: "CUI // SP-CTI"
  portionMarkings: true

# -----------------------------------------------------------------------
# Ingress
# -----------------------------------------------------------------------
ingress:
  enabled: true
  className: ""                   # nginx, alb, istio, etc.
  annotations: {}
  hosts:
    - host: icdev.local
      paths:
        - path: /
          pathType: Prefix
  tls:
    - secretName: icdev-tls
      hosts:
        - icdev.local

# -----------------------------------------------------------------------
# Network Policies
# -----------------------------------------------------------------------
networkPolicy:
  enabled: true                   # Default-deny + allow only intra-namespace

# -----------------------------------------------------------------------
# Pod Security
# -----------------------------------------------------------------------
podSecurity:
  runAsNonRoot: true
  runAsUser: 1000
  readOnlyRootFilesystem: true
  dropAllCapabilities: true

# -----------------------------------------------------------------------
# Auto-Scaling (HPA + PDB)
# D141: CPU/memory baseline; cloud-agnostic
# -----------------------------------------------------------------------
autoscaling:
  enabled: false                         # Set true to enable HPA
  # API Gateway — Core entry point
  apiGateway:
    minReplicas: 2
    maxReplicas: 12
    cpuTarget: 60
    memoryTarget: 70
  # Orchestrator — Core tier
  orchestrator:
    minReplicas: 2
    maxReplicas: 6
    cpuTarget: 60
    memoryTarget: 70
  # Architect — Core tier
  architect:
    minReplicas: 1
    maxReplicas: 4
    cpuTarget: 60
    memoryTarget: 70
  # Builder — Domain tier (high compute)
  builder:
    minReplicas: 1
    maxReplicas: 8
    cpuTarget: 70
    memoryTarget: 80
  # Compliance — Domain tier
  compliance:
    minReplicas: 1
    maxReplicas: 8
    cpuTarget: 70
    memoryTarget: 80
  # Security — Domain tier
  security:
    minReplicas: 1
    maxReplicas: 8
    cpuTarget: 70
    memoryTarget: 80
  # Infrastructure — Domain tier
  infrastructure:
    minReplicas: 1
    maxReplicas: 6
    cpuTarget: 70
    memoryTarget: 80
  # Knowledge — Support tier
  knowledge:
    minReplicas: 1
    maxReplicas: 4
    cpuTarget: 70
    memoryTarget: 80
  # Monitor — Support tier
  monitor:
    minReplicas: 1
    maxReplicas: 4
    cpuTarget: 70
    memoryTarget: 80
  # MBSE — Domain tier
  mbse:
    minReplicas: 1
    maxReplicas: 6
    cpuTarget: 70
    memoryTarget: 80
  # Modernization — Domain tier
  modernization:
    minReplicas: 1
    maxReplicas: 6
    cpuTarget: 70
    memoryTarget: 80
  # Requirements Analyst — Domain tier
  requirements-analyst:
    minReplicas: 1
    maxReplicas: 6
    cpuTarget: 70
    memoryTarget: 80
  # Supply Chain — Domain tier
  supply-chain:
    minReplicas: 1
    maxReplicas: 4
    cpuTarget: 70
    memoryTarget: 80
  # Simulation — Domain tier
  simulation:
    minReplicas: 1
    maxReplicas: 6
    cpuTarget: 70
    memoryTarget: 80
  # DevSecOps — Domain tier
  devsecops:
    minReplicas: 1
    maxReplicas: 6
    cpuTarget: 70
    memoryTarget: 80
  # Gateway — Domain tier
  gateway:
    minReplicas: 1
    maxReplicas: 4
    cpuTarget: 70
    memoryTarget: 80
  # Dashboard — Support tier (user-facing)
  dashboard:
    minReplicas: 2
    maxReplicas: 8
    cpuTarget: 60
    memoryTarget: 70

# -----------------------------------------------------------------------
# Topology Spread (D144)
# Distribute pods across zones and nodes for resilience
# -----------------------------------------------------------------------
topologySpread:
  enabled: true
  zoneSpread:
    maxSkew: 1
    whenUnsatisfiable: ScheduleAnyway    # Availability over strict spread
  nodeSpread:
    maxSkew: 1
    whenUnsatisfiable: ScheduleAnyway

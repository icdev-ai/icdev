<!-- [TEMPLATE: CUI // SP-CTI] -->
{% extends "portal_base.html" %}
{% set active_page = "dashboard" %}
{% block title %}Dashboard - {{ tenant_name }}{% endblock %}

{% block content %}
<nav class="breadcrumbs" aria-label="Breadcrumb">
    <span class="current">Home</span>
</nav>
<div class="page-header">
    <h1>Dashboard</h1>
    <p>Overview for {{ tenant_name }}</p>
</div>

<div class="summary-cards">
    <div class="card summary-card">
        <div class="card-label">Total Projects</div>
        <div class="card-value">{{ project_count }}</div>
    </div>
    <div class="card summary-card">
        <div class="card-label">Active Projects</div>
        <div class="card-value">{{ active_projects }}</div>
    </div>
    <div class="card summary-card">
        <div class="card-label">Compliance Score <span class="help-icon" title="Average compliance score across all frameworks (NIST, FedRAMP, CMMC). 100% means all controls are satisfied.">?</span></div>
        <div class="card-value {% if compliance_score >= 80 %}text-green{% elif compliance_score >= 50 %}text-yellow{% else %}text-red{% endif %}">
            {{ compliance_score }}%
        </div>
    </div>
    <div class="card summary-card">
        <div class="card-label">Active Alerts</div>
        <div class="card-value {% if alerts > 0 %}text-red{% else %}text-green{% endif %}">
            {{ alerts }}
        </div>
    </div>
</div>

<!-- Quick Actions -->
<div class="card">
    <h2 class="card-title">Quick Actions</h2>
    <div class="quick-actions">
        <button class="btn btn-primary" onclick="showToast('Navigate to project creation via API', 'info')">
            New Project
        </button>
        <button class="btn btn-secondary" onclick="showToast('SSP generation requires a project ID', 'info')">
            Generate SSP
        </button>
        <button class="btn btn-secondary" onclick="showToast('Security scan initiated via API', 'info')">
            Run Security Scan
        </button>
    </div>
</div>

<!-- Recent Activity -->
<div class="card">
    <h2 class="card-title">Recent Activity</h2>
    {% if recent_activity %}
    <div class="table-wrapper">
        <table class="data-table" aria-label="Recent activity log">
            <thead>
                <tr>
                    <th>Event</th>
                    <th>Action</th>
                    <th>Details</th>
                    <th>Timestamp</th>
                </tr>
            </thead>
            <tbody>
                {% for entry in recent_activity %}
                <tr>
                    <td><span class="badge badge-info" role="status">{{ entry.event_type }}</span></td>
                    <td>{{ entry.action }}</td>
                    <td class="td-truncate">{{ entry.details }}</td>
                    <td class="td-nowrap">{{ entry.recorded_at }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <p class="empty-state">No recent activity recorded.</p>
    {% endif %}
</div>
{% endblock %}

# [TEMPLATE: CUI // SP-CTI]
# ICDEV Horizontal Pod Autoscaler Manifests
# D141: CPU/memory baseline; custom metrics Phase 2
# Driven by args/scaling_config.yaml profiles
# Cloud-agnostic — requires Metrics Server on any K8s distribution

# ======================================================================
# Core Tier — Orchestrator (min=2, max=6, CPU 60%, Mem 70%)
# ======================================================================
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: icdev-orchestrator-hpa
  namespace: icdev
  labels:
    app.kubernetes.io/name: orchestrator
    app.kubernetes.io/part-of: icdev
    classification: CUI
    icdev.io/scaling-tier: core
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: icdev-orchestrator
  minReplicas: 2
  maxReplicas: 6
  metrics:
    - type: Resource
      resource:
        name: cpu
        target:
          type: Utilization
          averageUtilization: 60
    - type: Resource
      resource:
        name: memory
        target:
          type: Utilization
          averageUtilization: 70
  behavior:
    scaleUp:
      stabilizationWindowSeconds: 60
      policies:
        - type: Percent
          value: 100
          periodSeconds: 60
        - type: Pods
          value: 4
          periodSeconds: 60
      selectPolicy: Max
    scaleDown:
      stabilizationWindowSeconds: 300
      policies:
        - type: Percent
          value: 25
          periodSeconds: 60
---
# ======================================================================
# Core Tier — Architect (min=2, max=6, CPU 60%, Mem 70%)
# ======================================================================
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: icdev-architect-hpa
  namespace: icdev
  labels:
    app.kubernetes.io/name: architect
    app.kubernetes.io/part-of: icdev
    classification: CUI
    icdev.io/scaling-tier: core
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: icdev-architect
  minReplicas: 2
  maxReplicas: 6
  metrics:
    - type: Resource
      resource:
        name: cpu
        target:
          type: Utilization
          averageUtilization: 60
    - type: Resource
      resource:
        name: memory
        target:
          type: Utilization
          averageUtilization: 70
  behavior:
    scaleUp:
      stabilizationWindowSeconds: 60
      policies:
        - type: Percent
          value: 100
          periodSeconds: 60
        - type: Pods
          value: 4
          periodSeconds: 60
      selectPolicy: Max
    scaleDown:
      stabilizationWindowSeconds: 300
      policies:
        - type: Percent
          value: 25
          periodSeconds: 60
---
# ======================================================================
# Domain Tier — Builder (min=1, max=8, CPU 70%, Mem 80%)
# ======================================================================
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: icdev-builder-hpa
  namespace: icdev
  labels:
    app.kubernetes.io/name: builder
    app.kubernetes.io/part-of: icdev
    classification: CUI
    icdev.io/scaling-tier: domain
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: icdev-builder
  minReplicas: 1
  maxReplicas: 8
  metrics:
    - type: Resource
      resource:
        name: cpu
        target:
          type: Utilization
          averageUtilization: 70
    - type: Resource
      resource:
        name: memory
        target:
          type: Utilization
          averageUtilization: 80
  behavior:
    scaleUp:
      stabilizationWindowSeconds: 60
      policies:
        - type: Percent
          value: 50
          periodSeconds: 60
        - type: Pods
          value: 2
          periodSeconds: 60
      selectPolicy: Max
    scaleDown:
      stabilizationWindowSeconds: 300
      policies:
        - type: Percent
          value: 25
          periodSeconds: 60
---
# ======================================================================
# Domain Tier — Compliance (min=1, max=8, CPU 70%, Mem 80%)
# ======================================================================
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: icdev-compliance-hpa
  namespace: icdev
  labels:
    app.kubernetes.io/name: compliance
    app.kubernetes.io/part-of: icdev
    classification: CUI
    icdev.io/scaling-tier: domain
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: icdev-compliance
  minReplicas: 1
  maxReplicas: 8
  metrics:
    - type: Resource
      resource:
        name: cpu
        target:
          type: Utilization
          averageUtilization: 70
    - type: Resource
      resource:
        name: memory
        target:
          type: Utilization
          averageUtilization: 80
  behavior:
    scaleUp:
      stabilizationWindowSeconds: 60
      policies:
        - type: Percent
          value: 50
          periodSeconds: 60
        - type: Pods
          value: 2
          periodSeconds: 60
      selectPolicy: Max
    scaleDown:
      stabilizationWindowSeconds: 300
      policies:
        - type: Percent
          value: 25
          periodSeconds: 60
---
# ======================================================================
# Domain Tier — Security (min=1, max=8, CPU 70%, Mem 80%)
# ======================================================================
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: icdev-security-hpa
  namespace: icdev
  labels:
    app.kubernetes.io/name: security
    app.kubernetes.io/part-of: icdev
    classification: CUI
    icdev.io/scaling-tier: domain
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: icdev-security
  minReplicas: 1
  maxReplicas: 8
  metrics:
    - type: Resource
      resource:
        name: cpu
        target:
          type: Utilization
          averageUtilization: 70
    - type: Resource
      resource:
        name: memory
        target:
          type: Utilization
          averageUtilization: 80
  behavior:
    scaleUp:
      stabilizationWindowSeconds: 60
      policies:
        - type: Percent
          value: 50
          periodSeconds: 60
        - type: Pods
          value: 2
          periodSeconds: 60
      selectPolicy: Max
    scaleDown:
      stabilizationWindowSeconds: 300
      policies:
        - type: Percent
          value: 25
          periodSeconds: 60
---
# ======================================================================
# Domain Tier — Infrastructure (min=1, max=8, CPU 70%, Mem 80%)
# ======================================================================
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: icdev-infra-hpa
  namespace: icdev
  labels:
    app.kubernetes.io/name: infra
    app.kubernetes.io/part-of: icdev
    classification: CUI
    icdev.io/scaling-tier: domain
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: icdev-infra
  minReplicas: 1
  maxReplicas: 8
  metrics:
    - type: Resource
      resource:
        name: cpu
        target:
          type: Utilization
          averageUtilization: 70
    - type: Resource
      resource:
        name: memory
        target:
          type: Utilization
          averageUtilization: 80
  behavior:
    scaleUp:
      stabilizationWindowSeconds: 60
      policies:
        - type: Percent
          value: 50
          periodSeconds: 60
        - type: Pods
          value: 2
          periodSeconds: 60
      selectPolicy: Max
    scaleDown:
      stabilizationWindowSeconds: 300
      policies:
        - type: Percent
          value: 25
          periodSeconds: 60
---
# ======================================================================
# Domain Tier — MBSE (min=1, max=8, CPU 70%, Mem 80%)
# ======================================================================
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: icdev-mbse-hpa
  namespace: icdev
  labels:
    app.kubernetes.io/name: mbse-agent
    app.kubernetes.io/part-of: icdev
    classification: CUI
    icdev.io/scaling-tier: domain
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: icdev-mbse
  minReplicas: 1
  maxReplicas: 8
  metrics:
    - type: Resource
      resource:
        name: cpu
        target:
          type: Utilization
          averageUtilization: 70
    - type: Resource
      resource:
        name: memory
        target:
          type: Utilization
          averageUtilization: 80
  behavior:
    scaleUp:
      stabilizationWindowSeconds: 60
      policies:
        - type: Percent
          value: 50
          periodSeconds: 60
        - type: Pods
          value: 2
          periodSeconds: 60
      selectPolicy: Max
    scaleDown:
      stabilizationWindowSeconds: 300
      policies:
        - type: Percent
          value: 25
          periodSeconds: 60
---
# ======================================================================
# Domain Tier — Modernization (min=1, max=8, CPU 70%, Mem 80%)
# ======================================================================
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: icdev-modernization-hpa
  namespace: icdev
  labels:
    app.kubernetes.io/name: modernization-agent
    app.kubernetes.io/part-of: icdev
    classification: CUI
    icdev.io/scaling-tier: domain
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: icdev-modernization
  minReplicas: 1
  maxReplicas: 8
  metrics:
    - type: Resource
      resource:
        name: cpu
        target:
          type: Utilization
          averageUtilization: 70
    - type: Resource
      resource:
        name: memory
        target:
          type: Utilization
          averageUtilization: 80
  behavior:
    scaleUp:
      stabilizationWindowSeconds: 60
      policies:
        - type: Percent
          value: 50
          periodSeconds: 60
        - type: Pods
          value: 2
          periodSeconds: 60
      selectPolicy: Max
    scaleDown:
      stabilizationWindowSeconds: 300
      policies:
        - type: Percent
          value: 25
          periodSeconds: 60
---
# ======================================================================
# Domain Tier — Requirements Analyst (min=1, max=8, CPU 70%, Mem 80%)
# ======================================================================
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: icdev-requirements-analyst-hpa
  namespace: icdev
  labels:
    app.kubernetes.io/name: requirements-analyst-agent
    app.kubernetes.io/part-of: icdev
    classification: CUI
    icdev.io/scaling-tier: domain
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: icdev-requirements-analyst
  minReplicas: 1
  maxReplicas: 8
  metrics:
    - type: Resource
      resource:
        name: cpu
        target:
          type: Utilization
          averageUtilization: 70
    - type: Resource
      resource:
        name: memory
        target:
          type: Utilization
          averageUtilization: 80
  behavior:
    scaleUp:
      stabilizationWindowSeconds: 60
      policies:
        - type: Percent
          value: 50
          periodSeconds: 60
        - type: Pods
          value: 2
          periodSeconds: 60
      selectPolicy: Max
    scaleDown:
      stabilizationWindowSeconds: 300
      policies:
        - type: Percent
          value: 25
          periodSeconds: 60
---
# ======================================================================
# Domain Tier — Supply Chain (min=1, max=8, CPU 70%, Mem 80%)
# ======================================================================
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: icdev-supply-chain-hpa
  namespace: icdev
  labels:
    app.kubernetes.io/name: supply-chain-agent
    app.kubernetes.io/part-of: icdev
    classification: CUI
    icdev.io/scaling-tier: domain
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: icdev-supply-chain
  minReplicas: 1
  maxReplicas: 8
  metrics:
    - type: Resource
      resource:
        name: cpu
        target:
          type: Utilization
          averageUtilization: 70
    - type: Resource
      resource:
        name: memory
        target:
          type: Utilization
          averageUtilization: 80
  behavior:
    scaleUp:
      stabilizationWindowSeconds: 60
      policies:
        - type: Percent
          value: 50
          periodSeconds: 60
        - type: Pods
          value: 2
          periodSeconds: 60
      selectPolicy: Max
    scaleDown:
      stabilizationWindowSeconds: 300
      policies:
        - type: Percent
          value: 25
          periodSeconds: 60
---
# ======================================================================
# Domain Tier — Simulation (min=1, max=8, CPU 70%, Mem 80%)
# ======================================================================
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: icdev-simulation-hpa
  namespace: icdev
  labels:
    app.kubernetes.io/name: simulation-agent
    app.kubernetes.io/part-of: icdev
    classification: CUI
    icdev.io/scaling-tier: domain
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: icdev-simulation
  minReplicas: 1
  maxReplicas: 8
  metrics:
    - type: Resource
      resource:
        name: cpu
        target:
          type: Utilization
          averageUtilization: 70
    - type: Resource
      resource:
        name: memory
        target:
          type: Utilization
          averageUtilization: 80
  behavior:
    scaleUp:
      stabilizationWindowSeconds: 60
      policies:
        - type: Percent
          value: 50
          periodSeconds: 60
        - type: Pods
          value: 2
          periodSeconds: 60
      selectPolicy: Max
    scaleDown:
      stabilizationWindowSeconds: 300
      policies:
        - type: Percent
          value: 25
          periodSeconds: 60
---
# ======================================================================
# Domain Tier — Integration (min=1, max=8, CPU 70%, Mem 80%)
# ======================================================================
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: icdev-integration-hpa
  namespace: icdev
  labels:
    app.kubernetes.io/name: integration-agent
    app.kubernetes.io/part-of: icdev
    classification: CUI
    icdev.io/scaling-tier: domain
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: icdev-integration
  minReplicas: 1
  maxReplicas: 8
  metrics:
    - type: Resource
      resource:
        name: cpu
        target:
          type: Utilization
          averageUtilization: 70
    - type: Resource
      resource:
        name: memory
        target:
          type: Utilization
          averageUtilization: 80
  behavior:
    scaleUp:
      stabilizationWindowSeconds: 60
      policies:
        - type: Percent
          value: 50
          periodSeconds: 60
        - type: Pods
          value: 2
          periodSeconds: 60
      selectPolicy: Max
    scaleDown:
      stabilizationWindowSeconds: 300
      policies:
        - type: Percent
          value: 25
          periodSeconds: 60
---
# ======================================================================
# Domain Tier — DevSecOps (min=1, max=8, CPU 70%, Mem 80%)
# ======================================================================
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: icdev-devsecops-hpa
  namespace: icdev
  labels:
    app.kubernetes.io/name: devsecops-agent
    app.kubernetes.io/part-of: icdev
    classification: CUI
    icdev.io/scaling-tier: domain
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: icdev-devsecops
  minReplicas: 1
  maxReplicas: 8
  metrics:
    - type: Resource
      resource:
        name: cpu
        target:
          type: Utilization
          averageUtilization: 70
    - type: Resource
      resource:
        name: memory
        target:
          type: Utilization
          averageUtilization: 80
  behavior:
    scaleUp:
      stabilizationWindowSeconds: 60
      policies:
        - type: Percent
          value: 50
          periodSeconds: 60
        - type: Pods
          value: 2
          periodSeconds: 60
      selectPolicy: Max
    scaleDown:
      stabilizationWindowSeconds: 300
      policies:
        - type: Percent
          value: 25
          periodSeconds: 60
---
# ======================================================================
# Domain Tier — Gateway (min=1, max=8, CPU 70%, Mem 80%)
# ======================================================================
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: icdev-gateway-hpa
  namespace: icdev
  labels:
    app.kubernetes.io/name: gateway-agent
    app.kubernetes.io/part-of: icdev
    classification: CUI
    icdev.io/scaling-tier: domain
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: icdev-gateway
  minReplicas: 1
  maxReplicas: 8
  metrics:
    - type: Resource
      resource:
        name: cpu
        target:
          type: Utilization
          averageUtilization: 70
    - type: Resource
      resource:
        name: memory
        target:
          type: Utilization
          averageUtilization: 80
  behavior:
    scaleUp:
      stabilizationWindowSeconds: 60
      policies:
        - type: Percent
          value: 50
          periodSeconds: 60
        - type: Pods
          value: 2
          periodSeconds: 60
      selectPolicy: Max
    scaleDown:
      stabilizationWindowSeconds: 300
      policies:
        - type: Percent
          value: 25
          periodSeconds: 60
---
# ======================================================================
# Support Tier — Knowledge (min=1, max=4, CPU 75%, Mem 85%)
# ======================================================================
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: icdev-knowledge-hpa
  namespace: icdev
  labels:
    app.kubernetes.io/name: knowledge
    app.kubernetes.io/part-of: icdev
    classification: CUI
    icdev.io/scaling-tier: support
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: icdev-knowledge
  minReplicas: 1
  maxReplicas: 4
  metrics:
    - type: Resource
      resource:
        name: cpu
        target:
          type: Utilization
          averageUtilization: 75
    - type: Resource
      resource:
        name: memory
        target:
          type: Utilization
          averageUtilization: 85
  behavior:
    scaleUp:
      stabilizationWindowSeconds: 60
      policies:
        - type: Percent
          value: 25
          periodSeconds: 60
        - type: Pods
          value: 2
          periodSeconds: 60
      selectPolicy: Max
    scaleDown:
      stabilizationWindowSeconds: 600
      policies:
        - type: Percent
          value: 25
          periodSeconds: 60
---
# ======================================================================
# Support Tier — Monitor (min=1, max=4, CPU 75%, Mem 85%)
# ======================================================================
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: icdev-monitor-hpa
  namespace: icdev
  labels:
    app.kubernetes.io/name: monitor
    app.kubernetes.io/part-of: icdev
    classification: CUI
    icdev.io/scaling-tier: support
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: icdev-monitor
  minReplicas: 1
  maxReplicas: 4
  metrics:
    - type: Resource
      resource:
        name: cpu
        target:
          type: Utilization
          averageUtilization: 75
    - type: Resource
      resource:
        name: memory
        target:
          type: Utilization
          averageUtilization: 85
  behavior:
    scaleUp:
      stabilizationWindowSeconds: 60
      policies:
        - type: Percent
          value: 25
          periodSeconds: 60
        - type: Pods
          value: 2
          periodSeconds: 60
      selectPolicy: Max
    scaleDown:
      stabilizationWindowSeconds: 600
      policies:
        - type: Percent
          value: 25
          periodSeconds: 60
---
# ======================================================================
# Dashboard (min=2, max=10, CPU 70%, Mem 80%)
# ======================================================================
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: icdev-dashboard-hpa
  namespace: icdev
  labels:
    app.kubernetes.io/name: dashboard
    app.kubernetes.io/part-of: icdev
    classification: CUI
    icdev.io/scaling-tier: dashboard
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: icdev-dashboard
  minReplicas: 2
  maxReplicas: 10
  metrics:
    - type: Resource
      resource:
        name: cpu
        target:
          type: Utilization
          averageUtilization: 70
    - type: Resource
      resource:
        name: memory
        target:
          type: Utilization
          averageUtilization: 80
  behavior:
    scaleUp:
      stabilizationWindowSeconds: 30
      policies:
        - type: Percent
          value: 100
          periodSeconds: 60
        - type: Pods
          value: 4
          periodSeconds: 60
      selectPolicy: Max
    scaleDown:
      stabilizationWindowSeconds: 300
      policies:
        - type: Percent
          value: 25
          periodSeconds: 60
---
# ======================================================================
# API Gateway (min=2, max=12, CPU 60%, Mem 70%)
# ======================================================================
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: icdev-api-gateway-hpa
  namespace: icdev-platform
  labels:
    app.kubernetes.io/name: api-gateway
    app.kubernetes.io/part-of: icdev
    classification: CUI
    icdev.io/scaling-tier: api-gateway
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: icdev-api-gateway
  minReplicas: 2
  maxReplicas: 12
  metrics:
    - type: Resource
      resource:
        name: cpu
        target:
          type: Utilization
          averageUtilization: 60
    - type: Resource
      resource:
        name: memory
        target:
          type: Utilization
          averageUtilization: 70
  behavior:
    scaleUp:
      stabilizationWindowSeconds: 30
      policies:
        - type: Percent
          value: 100
          periodSeconds: 60
        - type: Pods
          value: 4
          periodSeconds: 60
      selectPolicy: Max
    scaleDown:
      stabilizationWindowSeconds: 300
      policies:
        - type: Percent
          value: 25
          periodSeconds: 60
